<div class="container mt-4">
<div class="banner-page" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url(https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/breakfast.jpg)">
  <div class="banner-heading">
    <h1><%= @project.title %></h1>
    <% if current_user.can_apply_to_project?(@project) %>
        <%= simple_form_for [@project, @project_member] do |f| %>
          <%= f.submit 'Apply', class: "button"%>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
<%# begin tab %>
<% if current_user.member_or_owner_of_project?(@project) %>
  <% if @project.is_owner?(current_user) || current_user.accepted_member_of_project?(@project) %>
    <ul class="nav nav-pills mb-3 mt-4 justify-content-around" id="pills-tab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link <%= params[:show_posts].present? ? '': 'active' %> nav-red" id="pills-details-tab" data-bs-toggle="pill" data-bs-target="#pills-details" type="button" role="tab" aria-controls="pills-details" aria-selected="true">Project Details:</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link nav-red  <%= params[:show_posts].present? ? 'active': '' %>" id="pills-posts-tab" data-bs-toggle="pill" data-bs-target="#pills-posts" type="button" role="tab" aria-controls="pills-posts" aria-selected="false">Project Posts:</button>
      </li>
    </ul>
  <% end %>
  <div class="tab-content" id="pills-tabContent">
  <div class= "project-body">
    <%# project details %>

    <div class="tab-pane fade <%= params[:show_posts].present? ? '': 'show active' %>" id="pills-details" role="tabpanel" aria-labelledby="pills-details-tab">
      <div class="container">

        <div class="d-flex background">
          <div class="backround small">
            <p>Categories:</p>
            <% @project.categories.each do |category| %>
              <p><%= category.name %></p>
            <% end %>
            <p>Skills needed:</p>
            <% @project.skills.each do |skill| %>
              <p><%= skill.name %></p>
            <% end %>
          </div>
          <div class="background big">
            <h5>Learn more about <%= @project.title %></h5>
            <p><%= @project.description %></p>
            <h5>Project stats:</h5>
            <p>This project was initiated by the legendary <%= @project.user.first_name %> from <%= @project.user.location %>. Learn more about her <%= link_to "here", user_path(@project.user) %>.</p>
            <p>The project has <%= pluralize(@project.project_members.count, "collaborators") %>.</p>
          </div>
        </div>
      </div>
      <%# project details %>
    </div>
    <%# posts %>
    <div class="tab-pane fade <%= params[:show_posts].present? ? 'show active': '' %>" id="pills-posts" role="tabpanel" aria-labelledby="pills-posts-tab">
      <div class="container">
        <div class="form">
          <h2>Create a new Post:</h2>
          <%= simple_form_for [@project, @post] do |f| %>
            <%= f.input :content, :label => "Share an update with your team members" %>
            <%= f.button :submit, class: "button" %>
          <% end %>
        </div>
        <div class="project-posts">
          <% @posts.each do |post| %>
            <div class="notification">
              <%# replace image %>
              <img src="https://kitt.lewagon.com/placeholder/users/krokrob" class="card-trip-user avatar-bordered" />
              <div class="notification-content">
                <p><strong><%= post.user.full_name %></strong></p>
                <p><%= post.content %></p>
              </div>
            </div>
          <%end %>
        </div>
      </div>
      <%# posts %>
    </div>
    <%# end tab %>
  </div>
<% else %>
   <div class="container">
    <div class="d-flex background">
      <div class="backround small">
        <h5>Categories:</h5>
        <% @project.categories.each do |category| %>
          <p><%= category.name %></p>
        <% end %>
        <p>Skills needed:</p>
        <% @project.skills.each do |skill| %>
          <p><%= skill.name %></p>
        <% end %>
        <p>Project Management</p>
        <p>Architecture</p>
      </div>
      <div class="background big">
        <h5>Learn more about <%= @project.title %></h5>
        <p><%= @project.description %></p>
        <h5>Project stats:</h5>
        <p>This project was initiated by the legendary <%= @project.user.first_name %> from <%= @project.user.location %>. Learn more about her <%= link_to "here", user_path(@project.user) %>.</p>
        <p>The project has <%= pluralize(@project.project_members.count, "volunteer") %>.</p>
        <% @project.project_members.each do |member| %>
        <p><%= member.user.first_name %></p>
        <% end %>
        <%=  %>
      </div>
    </div>
  </div>
<% end %>

</div>

<%# For Refactoring later:
def project_owner?(user)
    user == @project.user
  end

  def project_member?(user)
    user.projects.include?(@project)
  end %>
