<div class="container">
  <div class="justify-content-center mt-4" >
    <div class="text-center">
        <h1>Welcome to your Dashboard <%= current_user.first_name %></h1>

      <ul class="nav nav-pills mb-3 mt-4 justify-content-around" id="pills-tab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active nav-red" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">Your initiated projects</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link nav-red" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Your volunteer projects</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link nav-red" id="pills-messages-tab" data-bs-toggle="pill" data-bs-target="#pills-messages" type="button" role="tab" aria-controls="pills-messages" aria-selected="false">Messages</button>
        </li>
      </ul>

      <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
            <div class = "m-4 p-4">
              <%# #Projects initiated by the user %>
              <% current_user.initiated_projects.each do |project| %>
                <h4><%= link_to project.title, project_path(project) %></h4>
                <div>
                  <h5>Project Volunteers:</h5>
                  <% project.project_members.each do |project_member| %>
                    <div class = "p-4"><%= project_member.user.first_name %> (<%= project_member.status %>)
                    </div>
                    <%= status_link(project_member)%>
                    <%= link_to "Start chat", user_conversations_path(project_member.user), data: {turbo_method: :post}  %>
                    <% end %>
                </div>
              <% end %>
            </div>
        </div>
      </div>

      <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
        <div class = "m-4 p-4">
          <% if current_user.projects.empty? %>
            <%= "You currently don't have any projects" %>
            <%= link_to "Browse Projects Here", projects_path %>
          <% else %>
            <% current_user.projects.each do |project|  %>
            <%= project.title %>
            <% end %>
          <% end %>
        </div>
      </div>


      <div class="tab-pane fade show active" id="pills-messages" role="tabpanel" aria-labelledby="pills-messages-tab">
        <div class="m-4 p-4">
          <% @conversations.each do |conversation| %>
            <p><%= link_to "Chat with #{conversation.other_user(current_user).first_name}", conversation_path(conversation) %></p>
          <%end %>
        </div>
      </div>
    </div>
  </div>
</div>
